<!DOCTYPE html>
<html lang="en">
<head>
	<title>Uno</title>
	<meta name="author" content="Conner Jasmer">
	<meta name="description" content="Solo Uno game">
	<meta name="keywords" content="Uno">
<style>
    .card {
		margin: 8px;
		padding: 2px;
		font-size: 200%;
		background-color:red;
		color: azure;
		font-weight: 600;
		width:200px;
		height:300px;
		border-radius: 20px;
		text-align:left;
		vertical-align: center;
		position:relative;
		transform: rotate(2deg);
		border: 5px solid black;
		transition: 0.2s;
		margin-left: -100px;
		padding:10px;
    }
    .card:hover {
        font-size: 300%;
		border: 5px solid white;
		transform: translateY(-30px) rotate(5deg);
    }
    .deck {
        display: flex;
        flex-wrap: wrap;
        flex-direction: row;
		padding-left: 100px;
    }
	#maincard {
		rotate: 0deg;
	}
    
</style>
</head>

<body>
		<div class="wrapper" style="background: linear-gradient(to right, #ff5a00 0%, #ff3300 100%);">
			<div id="layoutpagenav"></div>

			<div id="navflex">
				<h1 id="toptext">UNO SOLO (Remove all Cards)</h1>
				<p><span id="hnumofmoves"></span> Moves</p>

				<center>
					<div class="card" id="hmaincard" style="transform: rotate(0deg); margin: 0px"></div>
					<button onclick="DrawCard()" id="drawcardbutton">Draw Card</button>
					<div class="deck" id="deck"></div>
				</center>

				<footer></footer>
			</div>
		</div>
</body>
</html>

<!-- -------------------------Javascript------------------------- -->
<script src="/layout.js"></script>
<script>
	// CODE -------------------------------------------------------------
var thedeck = document.getElementById('deck');
var hmaincard = document.getElementById('hmaincard');
var drawcardbutton = document.getElementById('drawcardbutton');
var toptext = document.getElementById('toptext');
var colors = ["red", "blue", "green", "rgb(191, 201, 0)"];
let deck = [];
let numofmoves = 0;

class Card {
    constructor(number, color, id) {
        this.number = number;
        this.color = color;
		this.id = id;
    }
}
let maincard = {};
maincard = new Card(1, "red", -1);
UpdatehMainCard();

function DrawCard() {
	numofmoves++;
    let ran = Math.floor(Math.random() * 9)
    let ran2 = Math.floor(Math.random() * colors.length)

        var card = new Card(ran, colors[ran2], deck.length);
        deck.push(card);
    ShowCards();
}
function ShowCards() {
    thedeck.innerHTML = "";
	hnumofmoves.innerHTML = numofmoves;
    for (var c of deck) {
        var div = document.createElement('div');
        thedeck.appendChild(div);
        div.className = "card";
        div.innerHTML = c.number;
        div.style.backgroundColor = c.color;
    }
}
function UpdateIds() {
	for (j = 0; j < deck.length; j++) { deck[j].id = j;}
}
function RemoveCard(theid){
	let newdeck = []
 deck.forEach(cc => {
	if(cc.id == theid){}
	else {newdeck.push(cc);}
 })
 deck = newdeck;
 UpdateIds();
}

// Start card values
function UpdatehMainCard(){
hmaincard.style.backgroundColor = maincard.color; 
hmaincard.innerHTML = maincard.number;
}


function ResetGame(){
// 3 default cards
deck = [];
function drawcards(amount){ for(i = 0; i < amount; i++) {DrawCard();}}
drawcards(3);
numofmoves = 0;
ShowCards();


}
ResetGame();

// click event for everything, obj is the thing clicked on
document.addEventListener("click", function(obj){
	var cardcolor = obj.target.style.backgroundColor;
	var cardnumber = obj.target.innerHTML;
	
	if(obj.target.textContent == "Play Again") {ResetGame();}

	// if the thing clicked is a card, and not the main card
   if (obj.target.className == "card" && obj.target.id != "hmaincard"){

    // If card clicked is same color or same number as the main card
    if(cardcolor == hmaincard.style.backgroundColor || cardnumber == maincard.number) {
		

		maincard.color = cardcolor;
		maincard.number = cardnumber;

		deck.forEach(crd => {
			if(crd.color == maincard.color && crd.number.toString() == maincard.number) {maincard.id = crd.id;}
		})
		
		numofmoves++;	

		UpdatehMainCard();
		RemoveCard(maincard.id);
		ShowCards();
		
	}
    else {} // err animation
   }
   
   if(deck.length == 0){ drawcardbutton.textContent = "Play Again"; toptext.innerHTML = "You Win";}
	else {drawcardbutton.textContent = "Draw Card";  toptext.innerHTML = "UNO SOLO (Remove all Cards)";}
}, false)
</script> 