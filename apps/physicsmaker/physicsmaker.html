<!DOCTYPE html>
<html lang="en">
<head>
	<title>Physics Maker</title>
	<meta name="author" content="Conner Jasmer">
	<meta name="description" content="Simulation you can control">
	<meta name="keywords" content="physics, maker">
<style>    
canvas {
    width: 100%;
    height: 20em;
    margin: 0em;
    background-color: rgb(27, 27, 27);

}
.holderdiv {
width: fit-content;
background-color: rgb(137, 137, 137);
margin-left: auto;
    margin-right: auto;
    margin-top: 2em;
}
table {
    background-color: blanchedalmond;
    border: .2em solid black;
    width: 100%;
    margin: 0em;
}
th {text-align: left;}
td select{ width: 100%;}
button {
    width: 100%;
    height: fit-content;
}
p {margin: 0em;}
.heading{
    background-color: white;
    font-weight: bolder;
    padding: .5em;
}
.settingsdiv{
    width: 50%;
}
</style>
</head>

<body>
	<div style="background-color: rgb(736 225 0)">
		<div class="wrapper" style="background: linear-gradient(to right, #ff6a00 0%, #ff3300 100%);">
			<div id="layoutpagenav"></div>

			<div class="bg">
                
                <div style="background-color: rgb(201, 201, 201); padding: .5em; text-align: center;"><p>Time Passed: <span id="hGameTime"></span> seconds | Particals: <span id="htotal"></span></p></div>
				<canvas id="canvas"></canvas>
                <div>
                    <div style="background-color: wheat; display: flex; padding: 0px; margin: 0em; justify-content: space-evenly;">
                </div>
			</div>
            <div class="holderdiv">
                <p class="heading">Add Particals</p>
                <table>
                    <tr><th>Color</th><td><select id="hColor"><option value="aqua">blue</option><option value="red">red</option><option value="green">green</option></select></td></tr>
                    <tr><th>Amount</th><td><input type="text" id="hAmount" value="1"></td></tr>
                </table>
                <button onclick="btnAdd()">Add</button>
                <button onclick="ClearBlobs()">Clear All</button>
                <p>
                    Blue & Red attract<br>
                    Same Colors repel<br>
                    Green repeled from everything
                </p>
            </div>
            
            <footer></footer>
		</div>
	</div>
</body>
</html>

<!-- -------------------------Javascript------------------------- -->
<script src="../../layout.js"></script>
<script>
    const canvas = document.getElementById("canvas");
	const ctx = canvas.getContext("2d")
    const particalsettingsdiv = document.getElementById("particalsettings");
    // h = from HTML
    
	let blobs = [];
    let blobsettings = [];
    let Physics = [
        {name: "red", attracts: ["aqua"], mass: 9999999},
        {name: "aqua", attracts: ["red"], mass: 9999999},
    ];

    class blob{
		constructor(id, x, y, color){
            this.id = id;
			this.x = x;
			this.y = y;
            this.color = color;
		}
        move(){
            // boundaries left and right
            if(this.x >= canvas.width) {this.x = canvas.width-1;}
            else if (this.x <= 0) {this.x = 1;}
            else {

            blobs.forEach(bl => {

                let distance = getDistance(this.x, this.y, bl.x, bl.y);
                let kilograms = 8999999;
                let gravforce = ((6.67*Math.pow(10,-11))*(kilograms*kilograms))/(distance*distance);
                if(gravforce > 300) {gravforce = -1}
                console.log(gravforce);

                let yneg = 1;   
                    if(bl.y < this.y){ yneg = -1;} else{yneg = 1;}
                let xneg = 1;   
                    if(bl.x < this.x){ xneg = -1;} else{xneg = 1;}

                if(this.color == "red" && bl.color=="aqua"){

                    this.x += ((AbsoluteValue(this.x - bl.x)/200)*xneg)*gravforce;
                    this.y += ((AbsoluteValue(this.y - bl.y)/200)*yneg)*gravforce;
                }
                else if(this.color == "aqua" && bl.color=="red"){
                    this.x += ((AbsoluteValue(this.x - bl.x)/200)*xneg)*gravforce;
                    this.y += ((AbsoluteValue(this.y - bl.y)/200)*yneg)*gravforce;
                }
                else if(this.color == "aqua" && bl.color=="green"){
                    gravforce *= 1.6;
                    this.x += ((AbsoluteValue(this.x - bl.x)/200)*xneg)*gravforce;
                    this.y += ((AbsoluteValue(this.y - bl.y)/200)*yneg)*gravforce;
                }
                
                else{
                    this.x += ((AbsoluteValue(this.x - bl.x)/200)*xneg*-1)*gravforce;
                    this.y += ((AbsoluteValue(this.y - bl.y)/200)*yneg*-1)*gravforce;
                }
            });

             }

            // boundaries up and down
            if (this.y <= 0) {this.y += 5;}
            else if (this.y >= canvas.height) {this.y -= 5;}
            else {


            }
        }
	}

    blobsettings.push(new blob(blobsettings.length, 0, 0, "red"));
    blobsettings.push(new blob(blobsettings.length, 0, 0, "aqua"));
    CreateBlobs(2, "red");
    CreateBlobs(2, "aqua");
    CreateBlobs(4, "green");

    canvas.addEventListener("click", CanvasClick);
 // Add button clicked, Create circles with entered values (amount, type (pred or prey))
 function CanvasClick(e){
    var rect = canvas.getBoundingClientRect();

    var rrr = new blob(blobs.length, e.pageX, e.pageY, "aqua")
	blobs.push(rrr);
    }


	
    

	function CreateBlobs(amount, thecolor) {
	for(i = 0; i < amount; i++){
	var e = new blob(blobs.length, randomnum(0, canvas.width), randomnum(0, canvas.height), thecolor)
	blobs.push(e)
	}
    }
    function ClearBlobs(){ blobs = []; }

	setInterval(update, 50);
	function update() {
	ctx.clearRect(0, 0, canvas.width, canvas.height)

	blobs.forEach(b => {
        b.move();
	

    ctx.fillStyle = b.color;
        ctx.beginPath();
		ctx.arc(b.x, b.y, 5, 0, Math.PI * 2)
		ctx.fill()
        ctx.closePath();
    })
    document.getElementById("htotal").innerHTML = blobs.length;
    }

    function btnAdd(){
        const hColor = document.getElementById("hColor").value;
        const hAmount = parseInt(document.getElementById("hAmount").value) || 1;
        CreateBlobs(hAmount, hColor);
    }

   
    function getDistance(xA, yA, xB, yB) { 
	var xDiff = xA - xB;  var yDiff = yA - yB;
	return Math.sqrt(xDiff * xDiff + yDiff * yDiff);
    }
    function AbsoluteValue(num){
        let r = num;
        if(num < 0){r *= -1}
        return r;
    }
</script> 